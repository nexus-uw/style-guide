<h1>Storage Selector</h1>

<p class="lead">This is a sample implementation of the storage selector</p>

<p><strong>Dependencies</strong> <span class="label label-info">html5</span></p>

<h3>Usage</h3>
<p>When a file is selected, the storage selector will send a message to its parent window.
   The message will contain the url of the selected file.</p>

<p>The current window will load the iframe and is responsible for providing the Company ID
as well as any desired styling on the iframe. </p>

<p>To retrieve the Company ID click on Settings from the menu of the Rise Vision Application.
The ID for the currently selected Company can be found in the URL where the ID is everything to the right of "company=", for example:</p>
<hljs>http://rva.risevision.com/#COMPANY_MANAGE/company=XXXXXXXX-XXXX-XXXX-XXXXXXXXXXXX</hljs>

<h3>Sample Implementation</h3>
<hljs include="'sample-usage'"></hljs>
<script type="text/ng-template" id="sample-usage">
  function loadStorageModal() {
    storageModal = document.createElement("iframe");
    storageModal.src = "http://storage.risevision.com/storage-modal.html#/files/company-uuid-string";
    storageModal.style.width = "90%";
    storageModal.style.height = "500px";
    storageModal = document.body.appendChild(storageModal);
  }

  window.addEventListener("load", loadStorageModal);
  window.addEventListener("message", handleStorageMessage, false);

  function handleStorageMessage(event) {
    console.log(event.data);   //log the selected file's url
  }
</script>

<style>
.backdrop-example {
  position: absolute;
  top: 0px;
  left: 0px;
  width: 100%;
  height: 100%;
  background-color: #e7e7e7;
  opacity: 0.9
}

.iframe-example {
  width: 90%;
  height: 500px;
  position: absolute;
  top: 20%;
  left: 5%;
  border-radius: 10px;
  box-shadow: 10px 10px 10px #aaaaaa;
  border-style: ridge;
  border-radius: 10px;
  border-width: 5px;
  padding: 5px;
  background-color: #f4f4f4;
}
</style>

<script>
  function loadStorageSelector() {
    backDrop = document.createElement("div");
    backDrop.className = "backdrop-example";
    document.body.appendChild(backDrop);
    storageModal = document.createElement("iframe");
    storageModal.src = "http://storage.risevision.com/storage-modal.html#/files/b428b4e8-c8b9-41d5-8a10-b4193c789443";
    storageModal.className = "iframe-example";
    storageModal = document.body.appendChild(storageModal);
    backDrop.onclick=function(event){
      if (event.target === backDrop) {
        storageModal.parentNode.removeChild(storageModal);
        backDrop.parentNode.removeChild(backDrop);
      }
    };
  }

  window.addEventListener("message", handleStorageMessage, false);

  function handleStorageMessage(event) {
    if (event.data.indexOf("risemedialibrary") > -1) {
      document.getElementById("urlMessage").innerHTML = event.data;
      storageModal.parentNode.removeChild(storageModal);
      backDrop.parentNode.removeChild(backDrop);
    }
  }
</script>

<h3>Click below to see an example</h3>
<button type="button" class="btn btn-default" onclick="loadStorageSelector()">load iframe</button>
<h6>URL message:</h6><p style="background-color: #dddddd; min-height: 2em" id="urlMessage"></p>
